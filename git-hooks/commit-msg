#!/usr/bin/env bash
set -euo pipefail

MSG_FILE="$1"

# Canonical AI attribution signatures (case-insensitive)
PATTERNS=(
  "co-authored-by:.*claude"
  "co-authored-by:.*anthropic"
  "co-authored-by:.*copilot"
  "co-authored-by:.*github"
  "co-authored-by:.*gpt"
  "co-authored-by:.*openai"
  "generated with.*claude"
  "generated by.*claude"
  "generated with.*copilot"
  "generated by.*copilot"
  "generated with.*gpt"
  "generated by.*gpt"
  "claude code"
  "anthropic"
  "github copilot"
  "openai"
  "chatgpt"
)

for pat in "${PATTERNS[@]}"; do
  if grep -Eiq "$pat" "$MSG_FILE"; then
    echo "ERROR: Commit message contains forbidden AI attribution:"
    echo "  pattern: $pat"
    echo
    echo "This repository forbids AI authorship or attribution markers."
    echo "Rewrite the commit message and retry."
    exit 1
  fi
done

exit 0
